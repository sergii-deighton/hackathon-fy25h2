<div class="page">
    <header class="topbar">
        <div class="topbar-left">
            <button class="burger" type="button" (click)="toggleMenu()">
                <span></span><span></span><span></span>
            </button>
            <div class="brand">
                <div class="brand-mark brand-logo" aria-label="Hackathon logo"></div>
                <div class="brand-text">
                    <div class="brand-name">Hackathon</div>
                    <div class="brand-sub">Control panel</div>
                </div>
            </div>
        </div>
        <div class="topbar-actions">
            <div class="lang-switch">
                <button
                    *ngFor="let lang of languages"
                    type="button"
                    class="lang-btn"
                    [class.active]="selectedLanguage === lang"
                    (click)="setLanguage(lang)"
                >
                    <span class="flag" [ngClass]="{ 'flag-en': lang === 'English', 'flag-fr': lang === 'French' }" aria-hidden="true"></span>
                    <span class="lang-label">{{ lang }}</span>
                </button>
            </div>
        </div>
    </header>

    <div class="page-body">
        <aside class="sidenav" [class.open]="isMenuOpen">
            <div class="user-block">
                <div class="avatar-sm">HP</div>
                <div class="user-meta">
                    <div class="name">Hackathon Team</div>
                    <div class="status"><span class="dot"></span> Online</div>
                </div>
            </div>
            <nav>
                <div class="section-label">MAIN NAVIGATION</div>
                <a class="link" [class.active]="selected === 'dashboard'" (click)="select('dashboard')">
                    <span class="icon bullet"></span>
                    <span class="text">Dashboard</span>
                </a>
                <a class="link" [class.active]="selected === 'notifications'" (click)="select('notifications')">
                    <span class="icon bullet"></span>
                    <span class="text">Notifications</span>
                    <span class="badge info">{{ notifications.length }}</span>
                </a>
                <a class="link" [class.active]="selected === 'send'" (click)="select('send')">
                    <span class="icon send"></span>
                    <span class="text">Send a notification</span>
                    <span class="badge success">NEW</span>
                </a>
            </nav>
        </aside>

        <section class="content">
            <div class="content-header" *ngIf="selected === 'dashboard'">
                <div class="title-block">
                    <h1>Notifications</h1>
                    <span class="subtitle">Latest updates across the workspace</span>
                </div>
            </div>

            <div class="notification-stats" *ngIf="selected === 'dashboard'">
                <div class="kpi-row">
                    <div class="kpi blue">
                        <div class="kpi-value">{{ totalCount }}</div>
                        <div class="kpi-label">Total notifications</div>
                        <a href="#" class="more">View all</a>
                    </div>
                    <div class="kpi green">
                        <div class="kpi-value">{{ infoCount }}</div>
                        <div class="kpi-label">Info</div>
                        <a href="#" class="more">View info</a>
                    </div>
                    <div class="kpi orange">
                        <div class="kpi-value">{{ warningCount }}</div>
                        <div class="kpi-label">Warnings</div>
                        <a href="#" class="more">View warnings</a>
                    </div>
                    <div class="kpi red">
                        <div class="kpi-value">{{ errorCount }}</div>
                        <div class="kpi-label">Errors</div>
                        <a href="#" class="more">View errors</a>
                    </div>
                </div>
            </div>

            <div class="panel main-card">
                <div class="panel-header">
                    <h2 *ngIf="selected === 'notifications'">Notifications</h2>
                    <h2 *ngIf="selected === 'send'">Send a Notification</h2>
                    <h2 *ngIf="selected === 'dashboard'">Notifications</h2>
                </div>
                <div class="panel-body">
                    <ng-container *ngIf="selected === 'dashboard'">
                        <p class="hint">Quick metrics for your control panel.</p>
                    </ng-container>

                    <ng-container *ngIf="selected === 'notifications'">
                        <p class="hint">Select "Notifications" in the left panel to manage recent updates.</p>
                        <div class="filter-tabs notification-filters">
                            <button type="button" [class.active]="category === 'all'" (click)="setCategory('all')">All</button>
                            <button type="button" [class.active]="category === 'info'" (click)="setCategory('info')">Info</button>
                            <button type="button" [class.active]="category === 'warning'" (click)="setCategory('warning')">Warning</button>
                            <button type="button" [class.active]="category === 'error'" (click)="setCategory('error')">Errors</button>
                        </div>
                        <ul class="message-list notification-list">
                            <li *ngFor="let msg of filteredNotifications" [class]="msg.type">
                                <div class="notification-head">
                                    <div class="meta">
                                        <span class="sender">{{ msg.sender }}</span>
                                        <span class="time">{{ msg.timestamp }}</span>
                                    </div>
                                    <div class="tags">
                                        <span class="type-tag" [class.info]="msg.type === 'info'" [class.warning]="msg.type === 'warning'" [class.error]="msg.type === 'error'">
                                            {{ msg.type }}
                                        </span>
                                        <span class="source-tag">{{ msg.source }}</span>
                                        <span class="status-dot" [class.unread]="msg.status === 'unread'"></span>
                                    </div>
                                </div>
                                <div class="text">
                                    <div class="title-line">{{ msg.title }}</div>
                                    <div class="body-line">{{ msg.body }}</div>
                                    <a *ngIf="msg.link" class="link-line" [href]="msg.link">Open link</a>
                                </div>
                                <div class="actions">
                                    <button type="button" class="btn ghost" (click)="toggleStatus(msg.id)">
                                        {{ msg.status === 'unread' ? 'Mark as read' : 'Mark as unread' }}
                                    </button>
                                    <button type="button" class="btn ghost danger" (click)="removeNotification(msg.id)">Delete</button>
                                </div>
                            </li>
                        </ul>
                    </ng-container>

                    <ng-container *ngIf="selected === 'send'">
                        <div class="notification-form">
                            <div class="form-row">
                                <div class="form-field">
                                    <label class="field-label" for="titleBox">Title</label>
                                    <input id="titleBox" type="text" [(ngModel)]="newTitle" placeholder="Deployment failed on mobile pipeline" />
                                </div>
                                <div class="form-field">
                                    <label class="field-label" for="typeSelect">Type</label>
                                    <select id="typeSelect" [(ngModel)]="newType">
                                        <option value="info">Info</option>
                                        <option value="warning">Warning</option>
                                        <option value="error">Error</option>
                                    </select>
                                </div>
                                <div class="form-field">
                                    <label class="field-label" for="sourceBox">Source</label>
                                    <input id="sourceBox" type="text" [(ngModel)]="newSource" placeholder="CI/CD" />
                                </div>
                            </div>
                            <label class="field-label" for="messageBox">Body</label>
                            <textarea
                                id="messageBox"
                                [(ngModel)]="newBody"
                                rows="4"
                                placeholder="Add any useful details for this notification"
                            ></textarea>
                            <label class="field-label" for="linkBox">Link (optional)</label>
                            <input id="linkBox" type="text" [(ngModel)]="newLink" placeholder="https://..." />
                            <button class="btn primary" (click)="sendMessage()">Send</button>

                            <div *ngIf="status.type" class="status" [class.success]="status.type === 'success'" [class.error]="status.type === 'error'">
                                {{ status.text }}
                            </div>
                        </div>
                    </ng-container>
                </div>
            </div>
        </section>
    </div>
</div>
<div class="overlay" *ngIf="isMenuOpen && isMobile" (click)="toggleMenu()"></div>
